<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive finger light show with dark theme">
    <title>Finger Light Show | Dark Mode</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
    
</head>
<body>
    <div class="app-container">
        <header>
            <div class="logo">
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2V4M12 20V22M4 12H2M6.31412 6.31412L4.8999 4.8999M17.6859 6.31412L19.1001 4.8999M6.31412 17.69L4.8999 19.1042M17.6859 17.69L19.1001 19.1042M21 12H23M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="glow-text">FINGER LIGHT SHOW</span>
            </div>
            <p class="tagline">Control the lights with your fingers in real-time</p>
        </header>

        <div class="main-grid">
            <div class="panel">
                <h2 class="section-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9C13.6569 9 15 10.3431 15 12Z" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 4V6M12 18V20M4 12H6M18 12H20M4.92893 4.92893L6.34315 6.34315M17.6569 17.6569L19.0711 19.0711M4.92893 19.0711L6.34315 17.6569M17.6569 6.34315L19.0711 4.92893" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    CAMERA FEED
                </h2>
                <div class="video-container">
                    <img id="videoFeed" src="" alt="Live camera feed showing hand gesture detection">
                </div>
                <div class="status-display">
                    <div class="status-card">
                        <div class="status-title">FINGERS DETECTED</div>
                        <div class="status-value" id="fingerCount">0</div>
                    </div>
                    <div class="status-card">
                        <div class="status-title">LIGHTS ACTIVE</div>
                        <div class="status-value" id="activeLights">0</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2 class="section-title">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 20H15M12 20V17M12 17L15 9C15 7.34315 13.6569 6 12 6C10.3431 6 9 7.34315 9 9L12 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    LIGHT CONTROLS
                </h2>
                <div class="controls-container">
                    <div class="light-grid">
                        <div class="light-bulb">
                            <div class="bulb" id="bulb1"></div>
                            <span class="bulb-label">LIGHT 1</span>
                        </div>
                        <div class="light-bulb">
                            <div class="bulb" id="bulb2"></div>
                            <span class="bulb-label">LIGHT 2</span>
                        </div>
                        <div class="light-bulb">
                            <div class="bulb" id="bulb3"></div>
                            <span class="bulb-label">LIGHT 3</span>
                        </div>
                        <div class="light-bulb">
                            <div class="bulb" id="bulb4"></div>
                            <span class="bulb-label">LIGHT 4</span>
                        </div>
                        <div class="light-bulb">
                            <div class="bulb" id="bulb5"></div>
                            <span class="bulb-label">LIGHT 5</span>
                        </div>
                    </div>
                    <h2 class="section-title">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 15V17M12 11V12M12 7V8M7 17H17C18.1046 17 19 16.1046 19 15V9C19 7.89543 18.1046 7 17 7H7C5.89543 7 5 7.89543 5 9V15C5 16.1046 5.89543 17 7 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                HOW TO USE
            </h2>
            <ul class="instructions-list">
                <li>Position your hand in front of your camera</li>
                <li>Raise fingers to activate corresponding lights</li>
                <li>1 finger = Light 1, 2 fingers = Lights 1 & 2, etc.</li>
                <li>Keep your hand steady for best detection</li>
            </ul>
                    
                    <div class="connection-status">
                        <div class="connection-dot" id="connectionDot"></div>
                        <div class="connection-text" id="connectionStatus">CONNECTING...</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
           

            // Connect to Socket.IO
            const socket = io();
            
            // DOM elements
            const videoFeed = document.getElementById('videoFeed');
            const fingerCountDisplay = document.getElementById('fingerCount');
            const activeLightsDisplay = document.getElementById('activeLights');
            const connectionDot = document.getElementById('connectionDot');
            const connectionStatus = document.getElementById('connectionStatus');
            
            // Initialize light bulbs
            const lightBulbs = [];
            for (let i = 1; i <= 5; i++) {
                lightBulbs.push(document.getElementById(`bulb${i}`));
            }

            // Event listeners
            socket.on('video_frame', function(data) {
                videoFeed.src = 'data:image/jpeg;base64,' + data.image;
            });

            socket.on('finger_count_update', function(data) {
                const count = data.count;
                fingerCountDisplay.textContent = count;
                activeLightsDisplay.textContent = count;

                // Update light bulbs
                lightBulbs.forEach((bulb, index) => {
                    if (index < count) {
                        bulb.classList.add('lit');
                    } else {
                        bulb.classList.remove('lit');
                    }
                });
            });

            socket.on('connect', function() {
                console.log('Connected to server');
                connectionDot.classList.add('connected');
                connectionStatus.textContent = 'CONNECTED';
            });

            socket.on('disconnect', function() {
                console.log('Disconnected from server');
                connectionDot.classList.remove('connected');
                connectionStatus.textContent = 'DISCONNECTED';
            });

            socket.on('connect_error', function() {
                console.log('Connection error');
                connectionDot.classList.remove('connected');
                connectionStatus.textContent = 'CONNECTION ERROR';
            });
        });
    </script>
</body>
</html>